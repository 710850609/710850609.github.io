---
layout: post
title:  领域驱动设计(DDD)的思考
date:   2019-05-24 17:19:00 +0800
categories: 设计模式
tag: DDD
---

* content
{:toc}



## 一、什么是领域驱动？
### 1、领域驱动的定义
- 领域驱动是以业务精准定位的数据模型驱动模式开发（这里的业务模型不一定是最终的数据存储的数据模型）。
- 由业务专家对业务的专业解读，对业务进行区域划分，对不同区域进行不同的业务建模，使用这些业务模型进行业务驱动开发。
- 使用面向对象进行编程，领域对象除了属性还有自己的功能（方法）。这样在完成一系列业务逻辑的时候，可以把注意力放在领域对象之间的逻辑关系，减少领域对象的内部功能实现。

### 2、代码工程分层
常见代码工程分层为（调用顺序从上往下）：
```
|-- interface （对外接口层）
|-- application （业务上下文，组织领域对象功能调用，以及一些不归属于领域对象功能的其他功能）
|-- domain （领域模型层，面向对象提供领域功能）
|-- infrastructure （基础建设层，负责领域对象中的数据存储和读取）
```

## 二、优缺点
### 1、好处
- 由于对业务进行了专业的领域划分，使得业务逻辑更加清晰，正确的业务归类有利于后续业务扩展。
- 领域对象面向对象编程，使得代码工程更加高内聚。将业务逻辑分散到各个领域对象中，使得对象外部代码更加精减。

### 2、坏处
- 要求专业、专业、专业的领域划分，这个是领域驱动的首要前提，也是最大的难度和挑战。需要参与人员（至少设计人员）有专业知识。因为代码实现的面向对象编程（高内聚），如果设计不当，带来的麻烦是相当大的。
- 面向对象编程，使得业务逻辑分散到各个领域模型中，对于后续接手且没有完备的文档或代码注释的人来说，就是灾难，难以快速了解到整体业务逻辑。
- 领域驱动设计中，领域模型是面向对象设计，自然持久层实现就是JPA标准。而JPA对于复杂查询，设计不好容易有性能问题。对于简单系统，JPA是友好的选择，但复杂的系统实现就不见得了，而领域驱动设计就是针对复杂系统而言的，所以在数据持久化方面，如果选择JPA，则需要面临JPA的问题，如果选择MyBatis这种SQL封装的框架的话，则需要在模型转换上多花些处理。


## 二、领域驱动模型和MVC模型有什么区别
### 1、代码工程
MVC代码架构说的是”模型层-视图层-控制层“，按数据流来说，应该是 控制层-数据层-视图层，这种分层合适简单的业务逻辑处理。

### 2、MVC的演变
随着业务越来越复杂，前后端分离的出现，MVC已经演变成了CSMD（常见国内项目架构），视图层剥离成独立的前端项目（可以是APP或是PC或是H5），多出了service层，专门进行业务逻辑处理，如下：
```
|-- controller （请求控制层，对外暴露接口）
|-- service （业务逻辑层）
|-- model （持久对象）
|-- dao （持久化层）
```
### 3、对比
从项目结构来看，可以类似找到一一对应的分层：
-  有统一对外接口分层
-  有业务层。但领域模型业务层是简单的，而MVC模型是复杂的。
- 有模型层。领域驱动的模型层是面向对象，含有对象功能，是充血模型。而MVC模型是JavaBean，只有属性，是贫血模型。
- 有持久化层

通过上面的比较，主要的区别在于MVC模型的业务逻辑集中在service层，而领域驱动模型的业务逻辑主要在model层，少量在application层。

## 三、我理解的领域驱动设计
### 1、解决的问题
- 解决复杂业务逻辑编写问题。通过领域划分，分散业务逻辑编写，在一个领域内专注领域内业务处理。
- 领域驱动模式使用面向对象的模式来编程，使得代码更加语义化。 

### 2、需要切换到领域驱动模式吗
这里思考下：领域驱动设计模式提出已经有好多年了，为什么没有流行起来?
- 领域驱动有一个前提，那就是专业建模。其实项目一般都做了模块划分，这里的划分是一样的意思,只是够不够专业而已。
- 现微服务化的出现，也是对业务领域划分的一种体现。
- 领域驱动一个关键的点是model是包含行为的。这个在MVC模式中，就是service + model层两层。
- 属性和行为分离，使得可以并行开发，不会存在不同人提交相同的代码文件而造成冲突。

综上所述，领域驱动除了面向对象编程外，特色设计模式在MVC模式中也能看到影子。但在model面向对象编程不利于团队协作开发，也不见得是个好选择。


### ３、领域驱动模式有什么可以借鉴学习
- 复杂问题简单化，简化单位功能，通过组合的方式来表达复杂功能
